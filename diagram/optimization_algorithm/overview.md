# 最適値探索アルゴリズム設計図

この図は以下の特性を持つ関数の最大値を探索するアルゴリズムのフローチャートです：
- 入力が小さすぎるとゼロ出力
- その後単調増加するが、増加率は徐々に低下
- 最大値を超えると突然ゼロに落ちる
- 入力には最大値（上限）がある

## フェーズ1: 有効範囲の特定

詳細な設計については [`optimization_algorithm_phase1.md`](./optimization_algorithm_phase1.md) を参照してください。

### フェーズ1の出力
フェーズ1の結果として、次の探索フェーズに渡す有効範囲 `(lower_bound, upper_bound)` を特定します。この範囲内に最適解が高確率で存在するよう、十分な余裕を持たせつつも、不要な範囲を排除します。

## フェーズ2: 黄金分割探索

詳細な設計については [`optimization_algorithm_phase2.md`](./optimization_algorithm_phase2.md) を参照してください。

### フェーズ2の出力
フェーズ2の結果として、次の探索フェーズに渡す狭められた区間 `(refined_lower, refined_upper)` を特定します。この区間内に最大値が高確率で存在し、次のフェーズでより精密な探索を行うための基盤となります。

## フェーズ3: 精密探索と結果返却

詳細な設計については [`optimization_algorithm_phase3.md`](./optimization_algorithm_phase3.md) を参照してください。

## アルゴリズムの主要フェーズ

### 1. 有効範囲の特定
- 非常に小さな値から始めて、徐々に値を増加させる
- ゼロから正の値に変わる「下限閾値」を特定
- さらに値を増やしていき、正の値からゼロに戻る「上限閾値」を特定
- これにより探索すべき「有効範囲」を確定する
- 入力上限値を常に考慮し、上限値を超える場合は上限値を上限閾値とする
- 全域でゼロの場合は早期に検出して終了

### 2. 黄金分割探索による効率的探索
- 有効範囲内で黄金分割探索を適用
- 黄金比（約0.618）を使って効率的に探索点を選定
- 評価値に基づいて探索範囲を継続的に絞り込む
- 入力上限値を常にチェックし、必要に応じて調整
- 区間が十分に狭くなるか、評価値の変化が小さくなったら次のフェーズへ

### 3. 境界近傍の精密探索
- 前フェーズで見つけた最良点周辺を詳細に探索
- 特に上限閾値（ゼロに落ちる境界）の直前を重点的に調査
- 小さなステップサイズで慎重に探索
- 十分な精度が得られたら探索完了

### 4. 終了条件
- 探索範囲が十分に狭くなった場合
- 連続する評価で値の改善が見られなくなった場合
- 全域でゼロ値の場合は早期に終了（特殊ケース）




